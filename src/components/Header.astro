---
import { getLangFromUrl, useTranslatedPath } from '../utils/i18n';
import LanguageSwitcher from './LanguageSwitcher.astro';

const lang = getLangFromUrl(Astro.url);
const translatePath = useTranslatedPath(lang);
const currentPath = Astro.url.pathname;

// Helper to check if a path is active
const isActive = (path: string) => {
  const translatedPath = translatePath(path);
  return currentPath === translatedPath || currentPath.startsWith(translatedPath + '/');
};
---

<header class="bg-white border-b border-gray-200 shadow-sm">
  <div class="container mx-auto px-4 py-6" style="max-width: 1000px;">
    <!-- Logo and Title - Horizontal Layout with Language Switcher -->
    <div class="flex items-center justify-between gap-8 mb-6">
      <!-- Name and Tagline (left side for Hebrew, left for English too) -->
      <div class={`${lang === 'he' ? 'order-1 text-right' : 'order-1 text-left'} flex-1`}>
        <a href={translatePath('/')}>
          <h1 class="text-4xl tracking-wider hover:text-gray-600 transition cursor-pointer" style={`font-family: ${lang === 'he' ? 'Alef' : 'Source Sans 3'}, sans-serif;`}>
            {lang === 'he' ? 'רון גבע' : 'Ron Geva'}
          </h1>
        </a>
        <p class="text-lg text-gray-600 tracking-wide mt-1" style={`font-family: ${lang === 'he' ? 'Alef' : 'Source Sans 3'}, sans-serif;`}>
          {lang === 'he' ? 'אמנות מהסוג המרגש' : 'Art of the emotive kind'}
        </p>
      </div>
      
      <!-- Right side: Language Switcher above Logo -->
      <div class={`${lang === 'he' ? 'order-2' : 'order-2'} flex flex-col items-end gap-2`}>
        <!-- Language Switcher - Top Right -->
        <LanguageSwitcher />
        
        <!-- Logo -->
        <a href={translatePath('/')} class="block">
          <img src="/images/home-1.png" alt="Ron Geva Logo" class="w-32 h-32 object-cover rounded-lg hover:opacity-80 transition" />
        </a>
      </div>
    </div>
    
    <!-- Navigation - Full Width with equal distribution -->
    <nav style="background-color: #D2CEC5;">
      <ul class="flex items-stretch" style="margin: 0; padding: 0; list-style: none;">
        <li style="flex: 1;">
          <a href={translatePath('/about')} class={`block px-6 text-center transition ${isActive('/about') ? '' : ''}`} style={`padding-top: 2px; padding-bottom: 2px; ${isActive('/about') ? 'background-color: #FFF8F1;' : ''}`}>
            {lang === 'he' ? 'אודות' : 'About'}
          </a>
        </li>
        <li style="flex: 1;">
          <a href={translatePath('/art')} class={`block px-6 text-center transition ${isActive('/art') ? '' : ''}`} style={`padding-top: 2px; padding-bottom: 2px; ${isActive('/art') ? 'background-color: #FFF8F1;' : ''}`}>
            {lang === 'he' ? 'אמנות' : 'Art'}
          </a>
        </li>
        <li style="flex: 1;">
          <a href={translatePath('/book')} class={`block px-6 text-center transition ${isActive('/book') ? '' : ''}`} style={`padding-top: 2px; padding-bottom: 2px; ${isActive('/book') ? 'background-color: #FFF8F1;' : ''}`}>
            {lang === 'he' ? 'ספר' : 'Book'}
          </a>
        </li>
        <li style="flex: 1;">
          <a href={translatePath('/blog')} class={`block px-6 text-center transition ${isActive('/blog') ? '' : ''}`} style={`padding-top: 2px; padding-bottom: 2px; ${isActive('/blog') ? 'background-color: #FFF8F1;' : ''}`}>
            {lang === 'he' ? 'בלוג' : 'Blog'}
          </a>
        </li>
      </ul>
    </nav>
  </div>
</header>

<style>
  nav ul li a:hover {
    background-color: #5B4D43 !important;
    color: white !important;
  }
</style>
